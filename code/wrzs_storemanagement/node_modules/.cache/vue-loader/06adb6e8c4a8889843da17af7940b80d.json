{"remainingRequest":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\sell-drawer-manage\\lattice-manage\\lattice-manage-edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\sell-drawer-manage\\lattice-manage\\lattice-manage-edit.vue","mtime":1686935646979},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\babel-loader\\lib\\index.js","mtime":1686936409992},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js","mtime":1686936410308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcFN0YXRlfSBmcm9tICd2dWV4Jw0KaW1wb3J0IFRpbnltY2UgZnJvbSAnQC9jb21wb25lbnRzL1RpbnltY2UnDQppbXBvcnQge2VkaXRMYXR0aWNlfSBmcm9tICJAL2FwaS9zZWxsLWRyYXdlci1tYW5hZ2UvbGF0dGljZS1tYW5hZ2UiDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImxhdHRpY2UtbWFuYWdlLWVkaXQiLA0KICBjb21wb25lbnRzOiB7DQogICAgVGlueW1jZQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcFN0YXRlKHsNCiAgICAgIHNlbGxEcmF3ZXJNYW5hZ2U6IHN0YXRlID0+IHN0YXRlWydzZWxsLWRyYXdlci1tYW5hZ2Uvc2VsbC1kcmF3ZXItbWFuYWdlJ10uc2VsbERyYXdlck1hbmFnZSwNCiAgICAgIGxhdHRpY2VNYW5hZ2U6IHN0YXRlID0+IHN0YXRlWydzZWxsLWRyYXdlci1tYW5hZ2UvbGF0dGljZS1tYW5hZ2UnXS5sYXR0aWNlTWFuYWdlDQogICAgfSkNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICAvLyDpqozor4HnqboNCiAgICBjb25zdCB2YWxpZGF0ZUVtcHR5ID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKCEoJycgKyB2YWx1ZSkudHJpbSgpKSB7DQogICAgICAgIGlmIChydWxlLmZpZWxkID09PSAnY2FiaW5ldF9udW1iZXInKSB7DQogICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXllYblk4HmoLznvJblj7cnKSkNCiAgICAgICAgfQ0KICAgICAgICBpZiAocnVsZS5maWVsZCA9PT0gJ2dvb2RzX25hbWUnKSB7DQogICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXllYblk4HmoLzmoIfpopgnKSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgY2FsbGJhY2soKQ0KICAgIH0NCiAgICByZXR1cm4gew0KICAgICAgZm9ybToge30sDQogICAgICBmb3JtUnVsZXM6IHsNCiAgICAgICAgY2FiaW5ldF9udW1iZXI6IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeWVhuWTgeagvOe8luWPtycNCiAgICAgICAgfSwgew0KICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVFbXB0eQ0KICAgICAgICB9XSwNCiAgICAgICAgZ29vZHNfbmFtZTogW3sNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5ZWG5ZOB5qC85qCH6aKYJw0KICAgICAgICB9LCB7DQogICAgICAgICAgdmFsaWRhdG9yOiB2YWxpZGF0ZUVtcHR5DQogICAgICAgIH1dLA0KICAgICAgICBnb29kc19wcmljZTogW3sNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5ZWG5ZOB5Lu35qC8Jw0KICAgICAgICB9XQ0KICAgICAgfSwNCiAgICAgIGZpbGVMaXN0OiBbXQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOi/lOWbng0KICAgIGJhY2soKSB7DQogICAgICB0aGlzLiRlbWl0KCdjb21wb25lbnRzQ2hhbmdlJywgJ2luZGV4JykNCiAgICB9LA0KICAgIC8vIOS4iuS8oOagvOWtkOS4u+WbvuaIkOWKn+eahOmSqeWtkA0KICAgIHVwbG9hZFN1Y2Nlc3MocmVzKSB7DQogICAgICB0aGlzLmZvcm0uZ29vZHNfaW1hZ2UgPSByZXMuZGF0YQ0KICAgIH0sDQogICAgLy8g5Yig6Zmk5LiK5Lyg5qC85a2Q55qE5Li75Zu+DQogICAgcmVtb3ZlVXBsb2FkKCkgew0KICAgICAgdGhpcy5mb3JtLmdvb2RzX2ltYWdlID0gJycNCiAgICB9LA0KICAgIC8vIOaPkOS6pA0KICAgIHN1Ym1pdCgpIHsNCiAgICAgIHRoaXMuJHJlZnNbJ2Zvcm0nXS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIGF3YWl0IGVkaXRMYXR0aWNlKHsNCiAgICAgICAgICAgIC4uLnRoaXMuZm9ybSwNCiAgICAgICAgICAgIGNhYmluZXRfaWQ6IHRoaXMuc2VsbERyYXdlck1hbmFnZS5jYWJpbmV0X2lkDQogICAgICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpDQogICAgICAgICAgICB0aGlzLmJhY2soKQ0KICAgICAgICAgIH0pDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZm9ybSA9IHRoaXMubGF0dGljZU1hbmFnZQ0KICAgIHRoaXMuZmlsZUxpc3QgPSBbew0KICAgICAgbmFtZTogJycsDQogICAgICB1cmw6IHRoaXMuYmFzZVVybCArIHRoaXMuZm9ybS5nb29kc19pbWFnZQ0KICAgIH1dDQogIH0NCn0NCg=="},{"version":3,"sources":["lattice-manage-edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"lattice-manage-edit.vue","sourceRoot":"src/views/sell-drawer-manage/lattice-manage","sourcesContent":["<template>\r\n  <div class=\"lattice-manage-edit\">\r\n    <el-row type=\"flex\" justify=\"center\">\r\n      <el-col :span=\"24\">\r\n        <el-form ref=\"form\" :model=\"form\" :rules=\"formRules\" label-width=\"100px\">\r\n          <el-form-item label=\"当前售货柜\">\r\n            <el-tag type=\"primary\">{{ sellDrawerManage.cabinet_name }}</el-tag>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品格编号\" prop=\"cabinet_number\">\r\n            <el-input placeholder=\"请输入商品格编号\" maxlength=\"25\" v-model=\"form.cabinet_number\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品格标题\" prop=\"goods_name\">\r\n            <el-input placeholder=\"请输入商品格标题\" maxlength=\"25\" v-model=\"form.goods_name\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品价格\" prop=\"goods_price\">\r\n            <el-input-number v-model=\"form.goods_price\" :precision=\"2\" :min=\"0\" :max=\"1000000\"></el-input-number>\r\n            <el-tag type=\"primary\">元</el-tag>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品格主图\" prop=\"goods_image\">\r\n            <el-upload\r\n              :action=\"uploadURL\"\r\n              list-type=\"picture-card\"\r\n              :limit=\"1\"\r\n              :file-list=\"fileList\"\r\n              :on-remove=\"removeUpload\"\r\n              :on-success=\"uploadSuccess\">\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n            <el-tag type=\"warning\">仅限上传一张</el-tag>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品介绍\">\r\n            <tinymce ref=\"tinymce\" v-model=\"form.goods_about\" :height=\"300\" />\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button @click=\"back\">返回商品格列表</el-button>\r\n            <el-button type=\"primary\" @click=\"submit\">立即修改</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex'\r\nimport Tinymce from '@/components/Tinymce'\r\nimport {editLattice} from \"@/api/sell-drawer-manage/lattice-manage\"\r\n\r\nexport default {\r\n  name: \"lattice-manage-edit\",\r\n  components: {\r\n    Tinymce\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      sellDrawerManage: state => state['sell-drawer-manage/sell-drawer-manage'].sellDrawerManage,\r\n      latticeManage: state => state['sell-drawer-manage/lattice-manage'].latticeManage\r\n    })\r\n  },\r\n  data() {\r\n    // 验证空\r\n    const validateEmpty = (rule, value, callback) => {\r\n      if (!('' + value).trim()) {\r\n        if (rule.field === 'cabinet_number') {\r\n          callback(new Error('请输入商品格编号'))\r\n        }\r\n        if (rule.field === 'goods_name') {\r\n          callback(new Error('请输入商品格标题'))\r\n        }\r\n      }\r\n      callback()\r\n    }\r\n    return {\r\n      form: {},\r\n      formRules: {\r\n        cabinet_number: [{\r\n          required: true,\r\n          message: '请输入商品格编号'\r\n        }, {\r\n          validator: validateEmpty\r\n        }],\r\n        goods_name: [{\r\n          required: true,\r\n          message: '请输入商品格标题'\r\n        }, {\r\n          validator: validateEmpty\r\n        }],\r\n        goods_price: [{\r\n          required: true,\r\n          message: '请输入商品价格'\r\n        }]\r\n      },\r\n      fileList: []\r\n    }\r\n  },\r\n  methods: {\r\n    // 返回\r\n    back() {\r\n      this.$emit('componentsChange', 'index')\r\n    },\r\n    // 上传格子主图成功的钩子\r\n    uploadSuccess(res) {\r\n      this.form.goods_image = res.data\r\n    },\r\n    // 删除上传格子的主图\r\n    removeUpload() {\r\n      this.form.goods_image = ''\r\n    },\r\n    // 提交\r\n    submit() {\r\n      this.$refs['form'].validate(async valid => {\r\n        if (valid) {\r\n          await editLattice({\r\n            ...this.form,\r\n            cabinet_id: this.sellDrawerManage.cabinet_id\r\n          }).then(() => {\r\n            this.$message.success('修改成功')\r\n            this.back()\r\n          })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  },\r\n  mounted() {\r\n    this.form = this.latticeManage\r\n    this.fileList = [{\r\n      name: '',\r\n      url: this.baseUrl + this.form.goods_image\r\n    }]\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}