{"remainingRequest":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\store-manage\\manJian-manage\\manJian-manage-index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\store-manage\\manJian-manage\\manJian-manage-index.vue","mtime":1686935646982},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\babel-loader\\lib\\index.js","mtime":1686936409992},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js","mtime":1686936410308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgbWFwU3RhdGUKfSBmcm9tICd2dWV4JwppbXBvcnQgewogIGdldE1hbkppYW5MaXN0LAogIGFkZE1hbkppYW4sCiAgZWRpdE1hbkppYW4sCiAgZGVsTWFuSmlhbgp9IGZyb20gJ0AvYXBpL3N0b3JlLW1hbmFnZS9tYW5KaWFuLW1hbmFnZS5qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnbWFuSmlhbi1tYW5hZ2UtaW5kZXgnLAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSh7CiAgICAgIHN0b3JlTWFuYWdlOiBzdGF0ZSA9PiBzdGF0ZVsnc3RvcmUtbWFuYWdlL3N0b3JlLW1hbmFnZSddLnN0b3JlTWFuYWdlLAogICAgICByb29tTWFuYWdlOiBzdGF0ZSA9PiBzdGF0ZVsnc3RvcmUtbWFuYWdlL3Jvb20tbWFuYWdlJ10ucm9vbU1hbmFnZQogICAgfSkKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWJsZURhdGE6IHsKICAgICAgICBsaXN0OiBbXSwKICAgICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgdG90YWw6IDAsCiAgICAgICAgc2VsZWN0aW9uT2JqOiBbXSwKICAgICAgICBzZWxlY3Rpb25JZHM6IFtdCiAgICAgIH0sCiAgICAgIC8vIOa3u+WKoC/nvJbovpHlvLnnqpcKICAgICAgbWFuSmlhbkRpYWxvZzogewogICAgICAgIHRpdGxlOiAnJywKICAgICAgICBmb3JtOiB7CiAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICBmdWxsOiAnJywKICAgICAgICAgIHJlZHVjZTogJycsCiAgICAgICAgICByZWR1Y2VfaWQ6ICcnCiAgICAgICAgfSwKICAgICAgICBmb3JtUnVsZXM6IHsKICAgICAgICAgIHRpdGxlOiBbewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeagh+mimCcKICAgICAgICAgIH1dLAogICAgICAgICAgZnVsbDogW3sKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmu6HotrPph5Hpop0nCiAgICAgICAgICB9XSwKICAgICAgICAgIHJlZHVjZTogW3sKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXkvJjmg6Dph5Hpop0nCiAgICAgICAgICB9XQogICAgICAgIH0sCiAgICAgICAgc2hvdzogZmFsc2UKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5Y+W5raI5by556qXCiAgICBoaWRlRGlhbG9nKCkgewogICAgICB0aGlzLm1hbkppYW5EaWFsb2cuc2hvdyA9IGZhbHNlCiAgICAgIHRoaXMubWFuSmlhbkRpYWxvZy50aXRsZSA9ICcnCiAgICAgIHRoaXMubWFuSmlhbkRpYWxvZy5mdWxsID0gJycKICAgICAgdGhpcy5tYW5KaWFuRGlhbG9nLnJlZHVjZSA9ICcnCiAgICAgIHRoaXMubWFuSmlhbkRpYWxvZy5yZWR1Y2VfaWQgPSAnJwogICAgICB0aGlzLiRyZWZzWydtYW5KaWFuRGlhbG9nRm9ybSddLnJlc2V0RmllbGRzKCkKICAgIH0sCiAgICAvLyDlvLnnqpfmj5DkuqQKICAgIHN1Ym1pdERpYWxvZygpIHsKICAgICAgdGhpcy4kcmVmc1snbWFuSmlhbkRpYWxvZ0Zvcm0nXS52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAodGhpcy5tYW5KaWFuRGlhbG9nLnRpdGxlID09PSAn5re75Yqg5ruh5YePJykgewogICAgICAgICAgICBhd2FpdCBhZGRNYW5KaWFuKHsKICAgICAgICAgICAgICAuLi50aGlzLm1hbkppYW5EaWFsb2cuZm9ybSwKICAgICAgICAgICAgICByb29tX2lkOiB0aGlzLnJvb21NYW5hZ2Uucm9vbV9pZAogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+a3u+WKoOaIkOWKnycpCiAgICAgICAgICAgICAgdGhpcy5oaWRlRGlhbG9nKCkKICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YS5jdXJyZW50UGFnZSA9IDEKICAgICAgICAgICAgICB0aGlzLmdldE1hbkppYW5MaXN0KCkKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0aGlzLm1hbkppYW5EaWFsb2cudGl0bGUgPT09ICfnvJbovpHmu6Hlh48nKSB7CiAgICAgICAgICAgIGF3YWl0IGVkaXRNYW5KaWFuKHRoaXMubWFuSmlhbkRpYWxvZy5mb3JtKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpCiAgICAgICAgICAgICAgdGhpcy5oaWRlRGlhbG9nKCkKICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YS5jdXJyZW50UGFnZSA9IDEKICAgICAgICAgICAgICB0aGlzLmdldE1hbkppYW5MaXN0KCkKICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIC8vIOi/lOWbnuS4iuS4gOmhtQogICAgYmFjaygpIHsKICAgICAgdGhpcy4kZW1pdCgnYmFjaycsICdyb29tJykKICAgIH0sCiAgICAvLyDmt7vliqDmu6Hlh48KICAgIGFkZE1hbkppYW4oKSB7CiAgICAgIHRoaXMubWFuSmlhbkRpYWxvZy50aXRsZSA9ICfmt7vliqDmu6Hlh48nCiAgICAgIHRoaXMubWFuSmlhbkRpYWxvZy5zaG93ID0gdHJ1ZQogICAgfSwKICAgIC8vIOe8lui+kea7oeWHjwogICAgZWRpdE1hbkppYW4oZGF0YSkgewogICAgICB0aGlzLm1hbkppYW5EaWFsb2cudGl0bGUgPSAn57yW6L6R5ruh5YePJwogICAgICB0aGlzLm1hbkppYW5EaWFsb2cuZm9ybS50aXRsZSA9IGRhdGEudGl0bGUKICAgICAgdGhpcy5tYW5KaWFuRGlhbG9nLmZvcm0uZnVsbCA9IGRhdGEuZnVsbAogICAgICB0aGlzLm1hbkppYW5EaWFsb2cuZm9ybS5yZWR1Y2UgPSBkYXRhLnJlZHVjZQogICAgICB0aGlzLm1hbkppYW5EaWFsb2cuZm9ybS5yZWR1Y2VfaWQgPSBkYXRhLnJlZHVjZV9pZAogICAgICB0aGlzLm1hbkppYW5EaWFsb2cuc2hvdyA9IHRydWUKICAgIH0sCiAgICAvLyDliKDpmaTmu6Hlh48KICAgIGRlbE1hbkppYW4ocmVkdWNlX2lkKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+aCqOehruWumuimgeWIoOmZpOivpea7oeWHj+WQlz8nLCAn5rip6aao5o+Q56S6JywgewogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICBhd2FpdCBkZWxNYW5KaWFuKHsKICAgICAgICAgIHJlZHVjZV9pZAogICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKQogICAgICAgICAgdGhpcy50YWJsZURhdGEuY3VycmVudFBhZ2UgPSAxCiAgICAgICAgICB0aGlzLmdldE1hbkppYW5MaXN0KCkKICAgICAgICB9KQogICAgICB9KS5jYXRjaCgoKSA9PiB7fSkKICAgIH0sCiAgICAvLyDojrflj5bmu6Hlh4/liJfooagKICAgIGFzeW5jIGdldE1hbkppYW5MaXN0KCkgewogICAgICBhd2FpdCBnZXRNYW5KaWFuTGlzdCh7CiAgICAgICAgcm9vbV9pZDogdGhpcy5yb29tTWFuYWdlLnJvb21faWQsCiAgICAgICAgbGltaXQ6IHRoaXMudGFibGVEYXRhLnBhZ2VTaXplLAogICAgICAgIHBhZ2U6IHRoaXMudGFibGVEYXRhLmN1cnJlbnRQYWdlCiAgICAgIH0pLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgdGhpcy50YWJsZURhdGEubGlzdCA9IGRhdGEubGlzdAogICAgICAgIHRoaXMudGFibGVEYXRhLnRvdGFsID0gZGF0YS5jb3VudAogICAgICB9KQogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0TWFuSmlhbkxpc3QoKQogIH0KfQo="},{"version":3,"sources":["manJian-manage-index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"manJian-manage-index.vue","sourceRoot":"src/views/store-manage/manJian-manage","sourcesContent":["<template>\r\n  <div class=\"manJian-manage-index\">\r\n    <el-button icon=\"el-icon-back\" @click=\"back\">返回房间列表</el-button>\r\n    <el-button type=\"primary\" icon=\"el-icon-circle-plus-outline\" @click=\"addManJian\">添加满减</el-button>\r\n    <el-button type=\"warning\" icon=\"el-icon-edit\" :disabled=\"tableData.selectionIds.length !== 1\"\r\n      @click=\"editManJian(tableData.selectionObj[0])\">编辑</el-button>\r\n    <el-button type=\"danger\" icon=\"el-icon-delete\" :disabled=\"!tableData.selectionIds.length\"\r\n      @click=\"delManJian(tableData.selectionIds)\">批量删除</el-button>\r\n    <el-tag type=\"primary\">{{ `当前位置：${storeManage.store_name}，${roomManage.room_name}` }}</el-tag>\r\n    <el-table ref=\"table\" :data=\"tableData.list\" border class=\"mt15\" height=\"calc(100vh - 225px)\"\r\n      @selection-change=\"$selectionChange($event, 'reduce_id')\">\r\n      <el-table-column type=\"selection\" width=\"50\"></el-table-column>\r\n      <el-table-column align=\"center\" label=\"ID\" prop=\"reduce_id\" width=\"80\"></el-table-column>\r\n      <el-table-column label=\"标题\" prop=\"title\"></el-table-column>\r\n      <el-table-column label=\"满\" prop=\"full\"></el-table-column>\r\n      <el-table-column label=\"送\" prop=\"reduce\"></el-table-column>\r\n      <el-table-column label=\"操作\" type=\"action\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"warning\" icon=\"el-icon-edit\" size=\"mini\" @click=\"editManJian(scope.row)\">编辑</el-button>\r\n          <el-button type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"delManJian([scope.row.reduce_id])\">删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <Pagination :tableData=\"tableData\" @pageChange=\"$pageChange\" :getList=\"getManJianList\"></Pagination>\r\n    <el-dialog :show-close=\"false\" :title=\"manJianDialog.title\" :visible.sync=\"manJianDialog.show\" width=\"30%\">\r\n      <el-form ref=\"manJianDialogForm\" :model=\"manJianDialog.form\" label-width=\"90px\" :rules=\"manJianDialog.formRules\">\r\n        <el-form-item label=\"标题\" prop=\"title\">\r\n          <el-input placeholder=\"请输入标题\" v-model.trim=\"manJianDialog.form.title\" maxlength=\"20\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"满\" prop=\"full\">\r\n          <el-input-number v-model=\"manJianDialog.form.full\" :min=\"1\" :max=\"50000\"></el-input-number>\r\n        </el-form-item>\r\n        <el-form-item label=\"减\" prop=\"reduce\">\r\n          <el-input-number v-model=\"manJianDialog.form.reduce\" :min=\"1\" :max=\"50000\"></el-input-number>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button @click=\"hideDialog\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitDialog\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapState\r\n  } from 'vuex'\r\n  import {\r\n    getManJianList,\r\n    addManJian,\r\n    editManJian,\r\n    delManJian\r\n  } from '@/api/store-manage/manJian-manage.js'\r\n\r\n  export default {\r\n    name: 'manJian-manage-index',\r\n    computed: {\r\n      ...mapState({\r\n        storeManage: state => state['store-manage/store-manage'].storeManage,\r\n        roomManage: state => state['store-manage/room-manage'].roomManage\r\n      })\r\n    },\r\n    data() {\r\n      return {\r\n        tableData: {\r\n          list: [],\r\n          currentPage: 1,\r\n          pageSize: 10,\r\n          total: 0,\r\n          selectionObj: [],\r\n          selectionIds: []\r\n        },\r\n        // 添加/编辑弹窗\r\n        manJianDialog: {\r\n          title: '',\r\n          form: {\r\n            title: '',\r\n            full: '',\r\n            reduce: '',\r\n            reduce_id: ''\r\n          },\r\n          formRules: {\r\n            title: [{\r\n              required: true,\r\n              message: '请输入标题'\r\n            }],\r\n            full: [{\r\n              required: true,\r\n              message: '请输入满足金额'\r\n            }],\r\n            reduce: [{\r\n              required: true,\r\n              message: '请输入优惠金额'\r\n            }]\r\n          },\r\n          show: false\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      // 取消弹窗\r\n      hideDialog() {\r\n        this.manJianDialog.show = false\r\n        this.manJianDialog.title = ''\r\n        this.manJianDialog.full = ''\r\n        this.manJianDialog.reduce = ''\r\n        this.manJianDialog.reduce_id = ''\r\n        this.$refs['manJianDialogForm'].resetFields()\r\n      },\r\n      // 弹窗提交\r\n      submitDialog() {\r\n        this.$refs['manJianDialogForm'].validate(async valid => {\r\n          if (valid) {\r\n            if (this.manJianDialog.title === '添加满减') {\r\n              await addManJian({\r\n                ...this.manJianDialog.form,\r\n                room_id: this.roomManage.room_id\r\n              }).then(() => {\r\n                this.$message.success('添加成功')\r\n                this.hideDialog()\r\n                this.tableData.currentPage = 1\r\n                this.getManJianList()\r\n              })\r\n            }\r\n            if (this.manJianDialog.title === '编辑满减') {\r\n              await editManJian(this.manJianDialog.form).then(() => {\r\n                this.$message.success('修改成功')\r\n                this.hideDialog()\r\n                this.tableData.currentPage = 1\r\n                this.getManJianList()\r\n              })\r\n            }\r\n          } else {\r\n            return false\r\n          }\r\n        })\r\n      },\r\n      // 返回上一页\r\n      back() {\r\n        this.$emit('back', 'room')\r\n      },\r\n      // 添加满减\r\n      addManJian() {\r\n        this.manJianDialog.title = '添加满减'\r\n        this.manJianDialog.show = true\r\n      },\r\n      // 编辑满减\r\n      editManJian(data) {\r\n        this.manJianDialog.title = '编辑满减'\r\n        this.manJianDialog.form.title = data.title\r\n        this.manJianDialog.form.full = data.full\r\n        this.manJianDialog.form.reduce = data.reduce\r\n        this.manJianDialog.form.reduce_id = data.reduce_id\r\n        this.manJianDialog.show = true\r\n      },\r\n      // 删除满减\r\n      delManJian(reduce_id) {\r\n        this.$confirm('您确定要删除该满减吗?', '温馨提示', {\r\n          type: 'warning'\r\n        }).then(async () => {\r\n          await delManJian({\r\n            reduce_id\r\n          }).then(() => {\r\n            this.$message.success('删除成功')\r\n            this.tableData.currentPage = 1\r\n            this.getManJianList()\r\n          })\r\n        }).catch(() => {})\r\n      },\r\n      // 获取满减列表\r\n      async getManJianList() {\r\n        await getManJianList({\r\n          room_id: this.roomManage.room_id,\r\n          limit: this.tableData.pageSize,\r\n          page: this.tableData.currentPage\r\n        }).then(data => {\r\n          this.tableData.list = data.list\r\n          this.tableData.total = data.count\r\n        })\r\n      }\r\n    },\r\n    mounted() {\r\n      this.getManJianList()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\r\n"]}]}