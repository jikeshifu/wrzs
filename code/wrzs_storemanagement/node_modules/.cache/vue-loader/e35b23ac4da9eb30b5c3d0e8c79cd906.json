{"remainingRequest":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\store-manage\\device-manage\\device-manage-add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\src\\views\\store-manage\\device-manage\\device-manage-add.vue","mtime":1689091378787},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\babel-loader\\lib\\index.js","mtime":1686936409992},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1686936409160},{"path":"D:\\coding\\wrzs\\wrzs_storemanagement\\node_modules\\vue-loader\\lib\\index.js","mtime":1686936410308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcFN0YXRlfSBmcm9tICJ2dWV4Ig0KaW1wb3J0IHthZGREZXZpY2V9IGZyb20gIkAvYXBpL3N0b3JlLW1hbmFnZS9kZXZpY2UtbWFuYWdlIg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJkZXZpY2UtbWFuYWdlLWFkZCIsDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoew0KICAgICAgc3RvcmVNYW5hZ2U6IHN0YXRlID0+IHN0YXRlWydzdG9yZS1tYW5hZ2Uvc3RvcmUtbWFuYWdlJ10uc3RvcmVNYW5hZ2UsDQogICAgICByb29tTWFuYWdlOiBzdGF0ZSA9PiBzdGF0ZVsnc3RvcmUtbWFuYWdlL3Jvb20tbWFuYWdlJ10ucm9vbU1hbmFnZQ0KICAgIH0pDQogIH0sDQogIGRhdGEoKSB7DQogICAgLy8g6aqM6K+B56m6DQogICAgY29uc3QgdmFsaWRhdGVFbXB0eSA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICghdmFsdWUudHJpbSgpKSB7DQogICAgICAgIGlmIChydWxlLmZpZWxkID09PSAnZGV2aWNlX25hbWUnKSB7DQogICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7fovpPlhaXorr7lpIflkI3np7AnKSkNCiAgICAgICAgfQ0KICAgICAgICBpZiAocnVsZS5maWVsZCA9PT0gJ2RldmljZV9zbicpIHsNCiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+i+k+WFpeiuvuWkh+W6j+WIl+WPtycpKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBjYWxsYmFjaygpDQogICAgfQ0KICAgIHJldHVybiB7DQogICAgICBmb3JtOiB7DQogICAgICAgIGRldmljZV9uYW1lOiAnJywNCiAgICAgICAgZGV2aWNlX3NuOiAnJywNCiAgICAgICAgZGV2aWNlX3R5cGU6IDEsDQogICAgICAgIHZvaWNlOiAnJywNCiAgICAgICAgZ3dfc246ICcnLA0KICAgICAgICB2b2x1bWU6ICcnDQogICAgICB9LA0KICAgICAgZm9ybVJ1bGVzOiB7DQogICAgICAgIHZvbHVtZTogW3sNCiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl6K+t6Z+z6Z+z6YePJw0KICAgICAgICB9XSwNCiAgICAgICAgZGV2aWNlX25hbWU6IFt7DQogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeiuvuWkh+WQjeensCcNCiAgICAgICAgfSwgew0KICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVFbXB0eQ0KICAgICAgICB9XSwNCiAgICAgICAgZGV2aWNlX3NuOiBbew0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXorr7lpIfluo/liJflj7cnDQogICAgICAgIH0sIHsNCiAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRlRW1wdHkNCiAgICAgICAgfV0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDov5Tlm57kuIrkuIDpobUNCiAgICBiYWNrKCkgew0KICAgICAgdGhpcy4kZW1pdCgnY29tcG9uZW50c0NoYW5nZScsICdpbmRleCcpDQogICAgfSwNCiAgICAvLyDmj5DkuqQNCiAgICBzdWJtaXQoKSB7DQogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICBhd2FpdCBhZGREZXZpY2Uoew0KICAgICAgICAgICAgcm9vbV9pZDogdGhpcy5yb29tTWFuYWdlLnJvb21faWQsDQogICAgICAgICAgICAuLi50aGlzLmZvcm0NCiAgICAgICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5re75Yqg5oiQ5YqfJykNCiAgICAgICAgICAgIHRoaXMuYmFjaygpDQogICAgICAgICAgfSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["device-manage-add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"device-manage-add.vue","sourceRoot":"src/views/store-manage/device-manage","sourcesContent":["<template>\r\n  <div class=\"device-manage-add\">\r\n    <el-button @click=\"back\" icon=\"el-icon-back\">返回设备列表</el-button>\r\n    <el-row type=\"flex\" justify=\"center\">\r\n      <el-col :span=\"8\">\r\n        <el-form ref=\"form\" :model=\"form\" :rules=\"formRules\" label-width=\"100px\">\r\n          <el-form-item label=\"房间信息\" prop=\"device_name\">\r\n            <el-tag type=\"primary\">{{ `${storeManage.store_name}，${roomManage.room_name}` }}</el-tag>\r\n          </el-form-item>\r\n          <el-form-item label=\"设备名称\" prop=\"device_name\">\r\n            <el-input placeholder=\"请输入设备名称\" maxlength=\"25\" v-model=\"form.device_name\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"设备序列号\" prop=\"device_sn\">\r\n            <el-input placeholder=\"请输入设备序列号\" maxlength=\"30\" v-model=\"form.device_sn\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"设备类型\" prop=\"device_type\">\r\n            <el-select v-model=\"form.device_type\" placeholder=\"请选择设备类型\">\r\n              <el-option label=\"门锁/门禁(W89/W76)\" :value=\"1\"></el-option>\r\n              <el-option label=\"大门/公共门(W89/W76)\" :value=\"2\"></el-option>\r\n              <el-option label=\"空开/断路器(W71/W72)\" :value=\"3\"></el-option>\r\n              <el-option label=\"云喇叭(W70)\" :value=\"4\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <!-- <el-form-item label=\"网关SN\" v-if=\"form.device_type !== 3\">\r\n            <el-input placeholder=\"选填\" maxlength=\"30\" v-model=\"form.gw_sn\"></el-input>\r\n          </el-form-item> -->\r\n          <el-form-item label=\"语音播报文本\" v-if=\"form.device_type == 1\">\r\n            <el-input type=\"textarea\" placeholder=\"设备语音文本\" maxlength=\"30\" rows=\"4\" show-word-limit v-model=\"form.voice\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"语音音量\" prop=\"volume\" v-if=\"form.device_type == 1\">\r\n            <el-input-number v-model=\"form.volume\" :min=\"1\" :max=\"10\"></el-input-number>\r\n          </el-form-item>\r\n          <el-form-item label=\"语音播报文本\" v-if=\"form.device_type == 4\">\r\n            <el-input type=\"textarea\" placeholder=\"设备语音文本\" maxlength=\"30\" rows=\"4\" show-word-limit v-model=\"form.voice\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"语音音量\" prop=\"volume\" v-if=\"form.device_type == 4\">\r\n            <el-input-number v-model=\"form.volume\" :min=\"1\" :max=\"10\"></el-input-number>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button @click=\"back\">返回</el-button>\r\n            <el-button type=\"primary\" @click=\"submit\">立即添加</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\"\r\nimport {addDevice} from \"@/api/store-manage/device-manage\"\r\n\r\nexport default {\r\n  name: \"device-manage-add\",\r\n  computed: {\r\n    ...mapState({\r\n      storeManage: state => state['store-manage/store-manage'].storeManage,\r\n      roomManage: state => state['store-manage/room-manage'].roomManage\r\n    })\r\n  },\r\n  data() {\r\n    // 验证空\r\n    const validateEmpty = (rule, value, callback) => {\r\n      if (!value.trim()) {\r\n        if (rule.field === 'device_name') {\r\n          callback(new Error('请输入设备名称'))\r\n        }\r\n        if (rule.field === 'device_sn') {\r\n          callback(new Error('请输入设备序列号'))\r\n        }\r\n      }\r\n      callback()\r\n    }\r\n    return {\r\n      form: {\r\n        device_name: '',\r\n        device_sn: '',\r\n        device_type: 1,\r\n        voice: '',\r\n        gw_sn: '',\r\n        volume: ''\r\n      },\r\n      formRules: {\r\n        volume: [{\r\n          required: true,\r\n          message: '请输入语音音量'\r\n        }],\r\n        device_name: [{\r\n          required: true,\r\n          message: '请输入设备名称'\r\n        }, {\r\n          validator: validateEmpty\r\n        }],\r\n        device_sn: [{\r\n          required: true,\r\n          message: '请输入设备序列号'\r\n        }, {\r\n          validator: validateEmpty\r\n        }]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 返回上一页\r\n    back() {\r\n      this.$emit('componentsChange', 'index')\r\n    },\r\n    // 提交\r\n    submit() {\r\n      this.$refs['form'].validate(async valid => {\r\n        if (valid) {\r\n          await addDevice({\r\n            room_id: this.roomManage.room_id,\r\n            ...this.form\r\n          }).then(() => {\r\n            this.$message.success('添加成功')\r\n            this.back()\r\n          })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}