{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-8eddfac8\"],{\"0faee\":function(t,e,r){\"use strict\";r(\"15d9\")},1346:function(t,e,r){\"use strict\";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r(\"div\",{staticClass:\"room-order-manage\"},[\"index\"===t.type?r(\"Index\",{on:{componentsChange:t.componentsChange}}):t._e()],1)},a=[],s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r(\"div\",{staticClass:\"room-order-manage-index\"},[r(\"el-select\",{attrs:{placeholder:\"请选择门店\",filterable:\"\",clearable:\"\"},on:{change:t.getRoomList},model:{value:t.tableData.store_id,callback:function(e){t.$set(t.tableData,\"store_id\",e)},expression:\"tableData.store_id\"}},t._l(t.storeArr,(function(t){return r(\"el-option\",{key:t.store_id,attrs:{value:t.store_id,label:t.store_name}})})),1),r(\"el-select\",{attrs:{placeholder:\"请选择房间\",filterable:\"\",clearable:\"\"},model:{value:t.tableData.room_id,callback:function(e){t.$set(t.tableData,\"room_id\",e)},expression:\"tableData.room_id\"}},t._l(t.roomArr,(function(t){return r(\"el-option\",{key:t.room_id,attrs:{value:t.room_id,label:t.room_name}})})),1),r(\"el-input\",{staticStyle:{width:\"300px\"},attrs:{maxlength:\"50\",placeholder:\"订单号查询\",clearable:\"\"},model:{value:t.tableData.order_sn,callback:function(e){t.$set(t.tableData,\"order_sn\",e)},expression:\"tableData.order_sn\"}}),r(\"el-select\",{attrs:{placeholder:\"订单状态\",filterable:\"\",clearable:\"\"},model:{value:t.tableData.order_status,callback:function(e){t.$set(t.tableData,\"order_status\",e)},expression:\"tableData.order_status\"}},[r(\"el-option\",{attrs:{value:\"1\",label:\"待开始\"}}),r(\"el-option\",{attrs:{value:\"2\",label:\"进行中\"}}),r(\"el-option\",{attrs:{value:\"3\",label:\"已完成\"}}),r(\"el-option\",{attrs:{value:\"4\",label:\"已取消\"}})],1),r(\"el-select\",{attrs:{placeholder:\"支付方式\",filterable:\"\",clearable:\"\"},model:{value:t.tableData.pay_type,callback:function(e){t.$set(t.tableData,\"pay_type\",e)},expression:\"tableData.pay_type\"}},[r(\"el-option\",{attrs:{value:\"balance\",label:\"钱包余额\"}}),r(\"el-option\",{attrs:{value:\"wechat\",label:\"微信\"}})],1),r(\"el-select\",{attrs:{placeholder:\"支付状态\",filterable:\"\",clearable:\"\"},model:{value:t.tableData.pay_status,callback:function(e){t.$set(t.tableData,\"pay_status\",e)},expression:\"tableData.pay_status\"}},[r(\"el-option\",{attrs:{value:\"0\",label:\"未支付\"}}),r(\"el-option\",{attrs:{value:\"1\",label:\"已支付\"}})],1),r(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\"},on:{click:t.submitSearch}},[t._v(\"查询\")]),r(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-refresh-right\"},on:{click:t.resetData}},[t._v(\"重置\")]),r(\"el-table\",{staticClass:\"mt15\",attrs:{border:\"\",height:\"calc(100vh - 225px)\",data:t.Mix_tableData.list}},[r(\"el-table-column\",{attrs:{label:\"订单ID\",prop:\"order_id\"}}),r(\"el-table-column\",{attrs:{label:\"开始时间\",width:\"180\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\" \"+t._s(t.$dateFormatter(e.row.orderRoom.start_time+\"000\",\"yy-mm-dd hh:mm:ss\"))+\" \")]}}])}),r(\"el-table-column\",{attrs:{label:\"结束时间\",width:\"180\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[t._v(\" \"+t._s(t.$dateFormatter(e.row.orderRoom.end_time+\"000\",\"yy-mm-dd hh:mm:ss\"))+\" \")]}}])}),r(\"el-table-column\",{attrs:{label:\"时长\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[1===e.row.orderRoom.room_info.room_type?r(\"div\",[t._v(t._s(t.$diffTime(+(e.row.orderRoom.start_time+\"000\"),+(e.row.orderRoom.end_time+\"000\")).fmt))]):t._e(),2===e.row.orderRoom.room_info.room_type?r(\"div\",[t._v(t._s(t.$diffDate(+(e.row.orderRoom.start_time+\"000\"),+(e.row.orderRoom.end_time+\"000\")))+\"天\")]):t._e(),4===e.row.orderRoom.room_info.room_type?r(\"div\",[t._v(t._s(t.$diffDate(+(e.row.orderRoom.start_time+\"000\"),+(e.row.orderRoom.end_time+\"000\")))+\"天\")]):t._e(),5===e.row.orderRoom.room_info.room_type?r(\"div\",[t._v(t._s(t.$diffTime(+(e.row.orderRoom.start_time+\"000\"),+(e.row.orderRoom.end_time+\"000\")).fmt))]):t._e()]}}])}),r(\"el-table-column\",{attrs:{label:\"总收益(元)\",prop:\"order_profit\"}}),r(\"el-table-column\",{attrs:{label:\"订单状态\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[1===e.row.order_status?r(\"el-tag\",{attrs:{type:\"info\"}},[t._v(\"待开始\")]):t._e(),2===e.row.order_status?r(\"el-tag\",{attrs:{type:\"primary\"}},[t._v(\"进行中\")]):t._e(),3===e.row.order_status?r(\"el-tag\",{attrs:{type:\"success\"}},[t._v(\"已完成\")]):t._e(),4===e.row.order_status?r(\"el-tag\",{attrs:{type:\"danger\"}},[t._v(\"已取消\")]):t._e()]}}])}),r(\"el-table-column\",{attrs:{label:\"支付方式\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[\"balance\"===e.row.pay_type?r(\"div\",{staticClass:\"pay-type\"},[r(\"span\",{staticClass:\"kj kj-qb\"}),t._v(\"钱包余额\")]):t._e(),\"wechat\"===e.row.pay_type?r(\"div\",{staticClass:\"pay-type\"},[r(\"span\",{staticClass:\"kj kj-wechat\"}),t._v(\"微信\")]):t._e()]}}])}),r(\"el-table-column\",{attrs:{label:\"支付状态\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[\"0\"===e.row.pay_status?r(\"el-tag\",{attrs:{type:\"info\"}},[t._v(\"未支付\")]):t._e(),\"1\"===e.row.pay_status?r(\"el-tag\",{attrs:{type:\"success\"}},[t._v(\"已支付\")]):t._e()]}}])}),r(\"el-table-column\",{attrs:{label:\"下单用户\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[r(\"el-button\",{attrs:{size:\"mini\",type:\"text\",icon:\"el-icon-view\"},on:{click:function(r){return t.checkUser(e.row.member)}}},[t._v(\"查看\")])]}}])}),r(\"el-table-column\",{attrs:{label:\"房间信息\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[r(\"el-button\",{attrs:{size:\"mini\",type:\"text\",icon:\"el-icon-view\"},on:{click:function(r){return t.checkRoom(e.row)}}},[t._v(\"查看\")])]}}])}),r(\"el-table-column\",{attrs:{label:\"操作\",type:\"action\",width:\"250\",align:\"center\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[1===e.row.order_status?r(\"el-button\",{attrs:{type:\"warning\",size:\"mini\"},on:{click:function(r){return t.cancelOrder(e.row.order_id)}}},[t._v(\"取消订单\")]):t._e(),3===e.row.order_status&&3!==e.row.deposit_status?r(\"el-button\",{attrs:{type:\"danger\",size:\"mini\"},on:{click:function(r){return t.returnDeposit(e.row)}}},[t._v(\"退还押金\")]):t._e()]}}])})],1),r(\"Pagination\",{attrs:{tableData:t.Mix_tableData,getList:t.getRoomOrderList},on:{pageChange:t.$pageChange}}),r(\"el-drawer\",{attrs:{title:\"下单用户信息\",visible:t.userDrawer.show,direction:\"ltr\"},on:{\"update:visible\":function(e){return t.$set(t.userDrawer,\"show\",e)}}},[r(\"el-form\",{attrs:{\"label-position\":\"left\",\"label-width\":\"80px\"}},[r(\"el-form-item\",{attrs:{label:\"微信昵称\"}},[t._v(t._s(t.userDrawer.data.nick_name))]),r(\"el-form-item\",{attrs:{label:\"微信头像\"}},[r(\"el-image\",{staticStyle:{width:\"100px\",height:\"100px\"},attrs:{src:t.userDrawer.data.avatar_url,fit:\"cover\"}})],1),r(\"el-form-item\",{attrs:{label:\"性别\"}},[1===t.userDrawer.data.gender?r(\"el-tag\",{attrs:{type:\"primary\"}},[t._v(\"男\")]):t._e(),2===t.userDrawer.data.gender?r(\"el-tag\",{attrs:{type:\"danger\"}},[t._v(\"女\")]):t._e()],1),r(\"el-form-item\",{attrs:{label:\"联系方式\"}},[t._v(t._s(t.userDrawer.data.mobile))]),r(\"el-form-item\",{attrs:{label:\"openid\"}},[t._v(t._s(t.userDrawer.data.openid))]),r(\"el-form-item\",{attrs:{label:\"地区\"}},[t._v(t._s(t.userDrawer.data.province))])],1)],1),r(\"el-drawer\",{attrs:{title:\"房间信息\",visible:t.roomDrawer.show,direction:\"ltr\"},on:{\"update:visible\":function(e){return t.$set(t.roomDrawer,\"show\",e)}}},[r(\"el-form\",{attrs:{\"label-position\":\"left\",\"label-width\":\"100px\"}},[r(\"el-form-item\",{attrs:{label:\"门店名称\"}},[t._v(t._s(t.roomDrawer.data.store.store_name))]),r(\"el-form-item\",{attrs:{label:\"营业时间\"}},[r(\"div\",t._l(t.roomDrawer.data.store.work_week,(function(e,o){return r(\"el-tag\",{key:e},[t._v(t._s(t._f(\"numTransZh_Week\")(e)))])})),1),r(\"div\",[t._v(t._s(t.roomDrawer.data.store.work_time_start)+\" ~ \"+t._s(t.roomDrawer.data.store.work_time_end))])]),r(\"el-form-item\",{attrs:{label:\"门店地址\"}},[t._v(t._s(t.roomDrawer.data.store.address))]),r(\"el-form-item\",{attrs:{label:\"门店主图\"}},[r(\"el-image\",{staticStyle:{width:\"100px\",height:\"100px\"},attrs:{src:t.baseUrl+t.roomDrawer.data.store.store_image,fit:\"cover\"}})],1),r(\"el-form-item\",{attrs:{label:\"房间名称\"}},[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_name))]),r(\"el-form-item\",{attrs:{label:\"可容纳人数\"}},[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_people)+\"人\")]),r(\"el-form-item\",{attrs:{label:\"押金\"}},[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_deposit)+\"元\")]),r(\"el-form-item\",{attrs:{label:\"价格\"}},[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_price)+\"元/\"+t._s(1===t.roomDrawer.data.orderRoom.room_info.room_type?\"小时\":2===t.roomDrawer.data.orderRoom.room_info.room_type?\"天\":3===t.roomDrawer.data.orderRoom.room_info.room_type?\"次\":4===t.roomDrawer.data.orderRoom.room_info.room_type?\"月\":5===t.roomDrawer.data.orderRoom.room_info.room_type?\"分钟\":\"\"))]),r(\"el-form-item\",{attrs:{label:\"房间面积\"}},[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_size)+\"平方米\")]),r(\"el-form-item\",{attrs:{label:\"房间标签\"}},[r(\"el-tag\",[t._v(t._s(t.roomDrawer.data.orderRoom.room_info.room_label))])],1)],1)],1),r(\"el-dialog\",{attrs:{title:\"退款押金\",visible:t.returnDepositDialog.show,width:\"30%\"},on:{\"update:visible\":function(e){return t.$set(t.returnDepositDialog,\"show\",e)}}},[r(\"el-form\",{ref:\"returnDepositDialogForm\",attrs:{\"label-width\":\"80px\",model:t.returnDepositDialog.form,rules:t.returnDepositDialog.formRules}},[r(\"el-form-item\",{attrs:{label:\"扣除金额\"}},[r(\"el-input-number\",{attrs:{step:.01,min:0,precision:2,max:t.returnDepositDialog.form.deposit},model:{value:t.returnDepositDialog.form.deposit_deduct,callback:function(e){t.$set(t.returnDepositDialog.form,\"deposit_deduct\",e)},expression:\"returnDepositDialog.form.deposit_deduct\"}})],1),r(\"el-form-item\",{attrs:{label:\"备注\"}},[r(\"el-input\",{attrs:{type:\"textarea\",rows:\"5\",maxlength:\"200\",\"show-word-limit\":\"\"},model:{value:t.returnDepositDialog.form.deposit_remarks,callback:function(e){t.$set(t.returnDepositDialog.form,\"deposit_remarks\",e)},expression:\"returnDepositDialog.form.deposit_remarks\"}})],1)],1),r(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[r(\"el-button\",{on:{click:t.hideReturnDepositDialog}},[t._v(\"取消\")]),r(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.submitReturnDeposit}},[t._v(\"确定\")])],1)],1)],1)},n=[],i=r(\"c7eb\"),l=r(\"1da1\"),u=(r(\"4e82\"),r(\"b775\"));function d(t){return Object(u[\"a\"])({url:\"/order.Room/list\",method:\"post\",data:t})}function c(t){return Object(u[\"a\"])({url:\"/order.Room/returnDeposit\",method:\"post\",data:t})}function m(t){return Object(u[\"a\"])({url:\"/order.Cancel/index\",method:\"post\",data:t})}var _=r(\"1596\"),p=r(\"eb4e\"),f={name:\"room-order-manage-index\",data:function(){return{storeArr:[],roomArr:[],tableData:{store_id:\"\",room_id:\"\",order_status:\"\",order_sn:\"\",pay_type:\"\",pay_status:\"\"},userDrawer:{show:!1,data:{}},roomDrawer:{show:!1,data:{store:{work_week:[]},orderRoom:{room_info:{}}}},returnDepositDialog:{show:!1,form:{order_id:\"\",deposit_deduct:\"\",deposit:\"\",deposit_remarks:\"\"},formRules:{deposit_deduct:[{required:!0,message:\"请输入退款金额\"}]}}}},methods:{hideReturnDepositDialog:function(){this.returnDepositDialog.show=!1,this.$refs[\"returnDepositDialogForm\"].resetFields()},submitReturnDeposit:function(){var t=this;this.$refs[\"returnDepositDialogForm\"].validate(function(){var e=Object(l[\"a\"])(Object(i[\"a\"])().mark((function e(r){return Object(i[\"a\"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,c({order_id:t.returnDepositDialog.form.order_id,deposit_deduct:t.returnDepositDialog.form.deposit_deduct,deposit_remarks:t.returnDepositDialog.form.deposit_remarks}).then((function(){t.$message.success(\"退款成功\"),t.returnDepositDialog.show=!1,t.getRoomOrderList()}));case 3:e.next=6;break;case 5:return e.abrupt(\"return\",!1);case 6:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},checkUser:function(t){this.userDrawer.show=!0,this.userDrawer.data=t},checkRoom:function(t){this.roomDrawer.show=!0,this.roomDrawer.data=t,this.roomDrawer.data.store.work_week=this.roomDrawer.data.store.work_week.sort()},submitSearch:function(){this.Mix_tableData.currentPage=1,this.getRoomOrderList()},resetData:function(){this.roomArr=[],this.tableData.store_id=\"\",this.tableData.room_id=\"\",this.tableData.pay_status=\"\",this.tableData.pay_type=\"\",this.tableData.order_sn=\"\",this.tableData.order_status=\"\"},cancelOrder:function(t){var e=this;this.$confirm(\"您确定要取消该订单吗?\",\"温馨提示\",{type:\"warning\"}).then(Object(l[\"a\"])(Object(i[\"a\"])().mark((function r(){return Object(i[\"a\"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,m({order_id:t}).then((function(){e.$message.success(\"已取消\"),e.Mix_tableData.currentPage=1,e.getRoomOrderList()}));case 2:case\"end\":return r.stop()}}),r)})))).catch((function(){}))},returnDeposit:function(t){this.returnDepositDialog.form.order_id=t.order_id,this.returnDepositDialog.form.deposit_deduct=t.deposit_deduct,this.returnDepositDialog.form.deposit=t.deposit,this.returnDepositDialog.show=!0},getRoomOrderList:function(){var t=this;return Object(l[\"a\"])(Object(i[\"a\"])().mark((function e(){return Object(i[\"a\"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d({page:t.Mix_tableData.currentPage,limit:t.Mix_tableData.pageSize,store_id:t.tableData.store_id,room_id:t.tableData.room_id,order_sn:t.tableData.order_sn,order_status:t.tableData.order_status,pay_type:t.tableData.pay_type,pay_status:t.tableData.pay_status}).then((function(e){t.Mix_tableData.list=e.list,t.Mix_tableData.total=e.count}));case 2:case\"end\":return e.stop()}}),e)})))()},getStoreList:function(){var t=this;return Object(l[\"a\"])(Object(i[\"a\"])().mark((function e(){return Object(i[\"a\"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(_[\"e\"])().then((function(e){t.storeArr=e.list}));case 2:case\"end\":return e.stop()}}),e)})))()},getRoomList:function(t){var e=this;return Object(l[\"a\"])(Object(i[\"a\"])().mark((function r(){return Object(i[\"a\"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.roomArr=[],e.tableData.room_id=\"\",r.next=4,Object(p[\"k\"])({store_id:t}).then((function(t){e.roomArr=t.list}));case 4:case\"end\":return r.stop()}}),r)})))()}},mounted:function(){this.getRoomOrderList(),this.getStoreList()}},b=f,h=(r(\"0faee\"),r(\"2877\")),D=Object(h[\"a\"])(b,s,n,!1,null,\"a1588b98\",null),w=D.exports,v={name:\"room-order-manage\",components:{Index:w},data:function(){return{type:\"index\"}},methods:{componentsChange:function(t){this.type=t}}},g=v,y=Object(h[\"a\"])(g,o,a,!1,null,\"de4418b0\",null);e[\"default\"]=y.exports},1596:function(t,e,r){\"use strict\";r.d(e,\"e\",(function(){return a})),r.d(e,\"a\",(function(){return s})),r.d(e,\"c\",(function(){return n})),r.d(e,\"b\",(function(){return i})),r.d(e,\"d\",(function(){return l}));var o=r(\"b775\");function a(t){return Object(o[\"a\"])({url:\"/store.Store/list\",method:\"post\",data:t})}function s(t){return Object(o[\"a\"])({url:\"/store.Store/add\",method:\"post\",data:t})}function n(t){return Object(o[\"a\"])({url:\"/store.Store/edit\",method:\"post\",data:t})}function i(t){return Object(o[\"a\"])({url:\"/store.Store/del\",method:\"post\",data:t})}function l(t){return Object(o[\"a\"])({url:\"/store.Store/status\",method:\"post\",data:t})}},\"15d9\":function(t,e,r){},\"4e82\":function(t,e,r){\"use strict\";var o=r(\"23e7\"),a=r(\"1c0b\"),s=r(\"7b0b\"),n=r(\"d039\"),i=r(\"a640\"),l=[],u=l.sort,d=n((function(){l.sort(void 0)})),c=n((function(){l.sort(null)})),m=i(\"sort\"),_=d||!c||!m;o({target:\"Array\",proto:!0,forced:_},{sort:function(t){return void 0===t?u.call(s(this)):u.call(s(this),a(t))}})},eb4e:function(t,e,r){\"use strict\";r.d(e,\"k\",(function(){return a})),r.d(e,\"a\",(function(){return s})),r.d(e,\"d\",(function(){return n})),r.d(e,\"c\",(function(){return i})),r.d(e,\"b\",(function(){return l})),r.d(e,\"j\",(function(){return u})),r.d(e,\"i\",(function(){return d})),r.d(e,\"f\",(function(){return c})),r.d(e,\"g\",(function(){return m})),r.d(e,\"e\",(function(){return _})),r.d(e,\"h\",(function(){return p}));var o=r(\"b775\");function a(t){return Object(o[\"a\"])({url:\"/room.Room/list\",method:\"post\",data:t})}function s(t){return Object(o[\"a\"])({url:\"/room.Room/add\",method:\"post\",data:t})}function n(t){return Object(o[\"a\"])({url:\"/room.Room/edit\",method:\"post\",data:t})}function i(t){return Object(o[\"a\"])({url:\"/room.Room/del\",method:\"post\",data:t})}function l(t){return Object(o[\"a\"])({url:\"/room.Room/copy\",method:\"post\",data:t})}function u(t){return Object(o[\"a\"])({url:\"/room.Room/status\",method:\"post\",data:t})}function d(t){return Object(o[\"a\"])({url:\"/room.Room/sort\",method:\"post\",data:t})}function c(t){return Object(o[\"a\"])({url:\"/room.Room/electricStopStatus\",method:\"post\",data:t})}function m(t){return Object(o[\"a\"])({url:\"/room.Room/electricStartStatus\",method:\"post\",data:t})}function _(t){return Object(o[\"a\"])({url:\"/room.Room/cancelStatus\",method:\"post\",data:t})}function p(t){return Object(o[\"a\"])({url:\"/room.Room/settlStatus\",method:\"post\",data:t})}}}]);","extractedComments":[]}